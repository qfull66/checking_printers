# checking_printers
## Скрипт автоматического мониторинга картриджей для принтеров

### Описание:

Скрипт автоматизирует отслеживание уровня тонера в принтерах, анализирует изменения и отправляет уведомления на почту при необходимости заказа картриджей.

### Функции:

• Ежедневное сканирование уровня тонера: Скрипт проверяет уровень тонера во всех принтерах ежедневно и записывает данные в лог-файл.
• Анализ изменений: Скрипт сравнивает данные о уровне тонера с предыдущим днем. Если уровень тонера увеличился, значит картридж был заменен. 
• Отчет о замене картриджа: Скрипт отправляет отчет на почту с информацией о замене картриджа, уменьшает остаток картриджей на один и показывает текущее количество картриджей на каждом принтере.
• Проверка остатков картриджей: Скрипт проверяет остаток картриджей на каждом принтере в определенный день месяца (настроенный параметр). 
• Автоматический заказ картриджей: 
  * Если остаток картриджей меньше или равен минимальному значению, скрипт отправляет уведомление на почту с просьбой дозаказать картриджи. 
  * Скрипт отправляет уведомление, если остаток картриджей на любом принтере равен 1 или меньше вне зависимости от дня месяца.
• Настраиваемые параметры: 
  * Минимальное и максимальное количество картриджей для каждого принтера можно установить индивидуально.
  * Можно настроить день месяца для проверки остатков картриджей.

### Преимущества:

• Автоматизация: Скрипт автоматизирует мониторинг и заказы, освобождая время администратора.
• Своевременное оповещение: Скрипт гарантирует, что картриджи будут заказаны вовремя, чтобы избежать перебоев в работе.
• Прозрачность: Скрипт предоставляет отчеты о замене картриджей и остатках, обеспечивая прозрачность процесса.
## Используемые библиотеки

### 1. sqlite3
- Назначение: Работа с базой данных SQLite.
- Применение: Используется для хранения логов о уровне тонера и истории замены картриджей. Позволяет сохранить информацию о состоянии принтеров и остатках картриджей.

### 2. configparser
- Назначение: Чтение и запись настройки из конфигурационных файлов.
- Применение: Упрощает настройку параметров скрипта, таких как параметры подключения к базе данных, адреса электронной почты и минимумы/максимумы картриджей для каждого принтера.

### 3. smtplib
- Назначение: Отправка электронной почты.
- Применение: Используется для отправки уведомлений о замене картриджей и рекомендаций по заказу новых. Скрипт будет формировать и отправлять электронные письма с отчетами.

### 4. email.mime.text и email.mime.multipart
- Назначение: Создание HTML и текстовых сообщений электронной почты.
- Применение: Позволяет формировать сложные структуры электронных писем, включая как текстовые, так и HTML-части, что улучшает визуальное восприятие отчетов.

### 5. jinja2
- Назначение: Шаблонизация текстов.
- Применение: Используется для создания шаблонов отчетов об уровнях тонера и остатках картриджей, что позволяет легко изменять форматирование и содержание уведомлений.

### 6. pysnmp.hlapi
- Назначение: Работа с SNMP (Simple Network Management Protocol).
- Применение: Используется для получения информации о состоянии принтеров и уровнях тонера через SNMP-протокол. Это особенно важно для мониторинга сетевых принтеров.

### 7. os
- Назначение: Операции с файловой системой.
- Применение: Используется, например, для работы с путями к файлам логов и конфигурации, а также для проверки наличия требуемых директорий и файлов.

### 8. datetime
- Назначение: Работа с датами и временем.
- Применение: Используется для проверки даты выполнения скрипта, а также для анализа логов по дате (например, чтобы определить, когда был отправлен последний отчет или когда нужно проверять остатки картриджей).

## Примерный скелет скрипта

Для более полного понимания, вот примерный скелет вашего скрипта, который иллюстрирует использование этих библиотек и основной логики:

import sqlite3
import configparser
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from jinja2 import Environment, FileSystemLoader
from pysnmp.hlapi import *
import os
import datetime

# Чтение конфигурационных данных
config = configparser.ConfigParser()
config.read('config.ini')

# Подключение к базе данных SQLite
conn = sqlite3.connect('toner_logs.db')
cursor = conn.cursor()

# Проверка состояния принтеров через SNMP
def check_printer_status(printer_ip):
  # Пример кода для получения данных об уровне тонера через SNMP
  return None

# Отправка уведомлений на почту
def send_email(subject, message):
  # Формирование и отправка письма
  pass

# Основной функционал скрипта
def main():
  today = datetime.date.today()
  
  # Проверка уровня тонера
  for printer in printers:
    toner_level = check_printer_status(printer['ip'])
    # Логика сравнения и отслеживания картриджей
    
  # Проверка остатков картриджей
  # Логика отправки запросов на заказ картриджей
  
if __name__ == "__main__":
  main()
